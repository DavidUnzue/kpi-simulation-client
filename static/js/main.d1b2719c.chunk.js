(this["webpackJsonpsimulator-client"]=this["webpackJsonpsimulator-client"]||[]).push([[0],{24:function(e,t,n){e.exports=n(35)},29:function(e,t,n){},31:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(22),c=n.n(o),i=(n(29),n(12)),l=n.n(i),s=n(15),u=n(6),p=n(7),m=n(9),f=n(8),h=(n(31),function(e){var t=e.bins;return Object.keys(t).length>0?r.a.createElement("div",{className:"Bins"},r.a.createElement("details",null,r.a.createElement("summary",null,"Booking distance bins"),r.a.createElement("p",null,'How many bookings happened for every "kilometer bin". E.g. how many bookings had a distance between 0 and 1km, 1 and 2kms, etc.'),r.a.createElement("div",{className:"BinsList"},Object.keys(t).map((function(e,n){return r.a.createElement("div",{key:n,className:"BinItem"},e,": ",t[e])}))))):null}),d=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={inputValue:"10"},e.handleChange=function(t){e.setState({inputValue:t.target.value})},e.handleSubmit=function(){e.props.onSubmit(e.state.inputValue)},e}return Object(p.a)(n,[{key:"render",value:function(){var e=this.state.inputValue;return r.a.createElement("form",{className:"Form"},r.a.createElement("label",{className:"FormLabel",htmlFor:"requestsNumber"},"Number of requests (max. 10)"),r.a.createElement("input",{id:"requestsNumber",className:"FormInput",value:e,min:"1",max:"10",type:"number",onChange:this.handleChange}),r.a.createElement("button",{className:"FormButton",type:"button",onClick:this.handleSubmit},"Run simulation"))}}]),n}(r.a.Component),g=n(11),v="https://kpi-simulator-api.herokuapp.com/",b="pk.eyJ1IjoiZGF2aWR1bSIsImEiOiJja2ZsNWhjdzUwcHhqMnNuejRoZzF0d2swIn0.rFJ5_Iw7gGBq-beLy1tE-w",y=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"roundNumber",value:function(e){return Math.round(100*e)/100}},{key:"render",value:function(){var e=this.props,t=e.info,n=e.onClose;return t&&r.a.createElement(g.b,{latitude:t.lat,longitude:t.long,closeButton:!0,closeOnClick:!1,onClose:n,anchor:"top",className:"popup"},r.a.createElement("p",null,r.a.createElement("i",null,t.category),r.a.createElement("br",null),r.a.createElement("strong",null,t.text)),r.a.createElement("p",null,"Latitude: ",this.roundNumber(t.lat),r.a.createElement("br",null),"Longitude: ",this.roundNumber(t.long)))}}]),n}(r.a.Component),E=n(16);function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function O(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var j=r.a.createElement("path",{d:"M10 20S3 10.87 3 7a7 7 0 1 1 14 0c0 3.87-7 13-7 13zm0-11a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"}),w=function(e){var t=e.svgRef,n=e.title,a=O(e,["svgRef","title"]);return r.a.createElement("svg",k({viewBox:"0 0 20 20",ref:t},a),n?r.a.createElement("title",null,n):null,j)},N=r.a.forwardRef((function(e,t){return r.a.createElement(w,k({svgRef:t},e))})),C=(n.p,function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props,t=e.category,n=e.data,a=e.color,o=e.onClick;return n.map((function(e){var n,c=null===(n=e.geometry)||void 0===n?void 0:n.coordinates,i=Object(E.a)(c,2),l=i[0],s=i[1],u=e.properties,p=u.name,m=u.id,f={category:t,lat:s,long:l,text:p};return r.a.createElement(g.a,{key:m,latitude:s,longitude:l,offsetLeft:-12,offsetTop:-24},r.a.createElement(N,{width:24,height:24,title:p,onClick:function(){return o(f)},className:"markerIcon",fill:a}))}))}}]),n}(r.a.PureComponent)),P=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).mapContainer=r.a.createRef(),e.state={viewport:{latitude:52.5300463,longitude:13.4007813,zoom:10}},e.openPopup=function(t){e.props.changePopup(t)},e.closePopup=function(){e.props.changePopup(null)},e}return Object(p.a)(n,[{key:"render",value:function(){var e=this,t=this.state.viewport,n=this.props,a=n.pointsByCategory,o=n.popupInfo;return r.a.createElement("div",{className:"mapContainer"},r.a.createElement(g.c,Object.assign({ref:this.mapContainer},t,{className:"map",mapStyle:"mapbox://styles/mapbox/streets-v9",width:"100%",height:"100%",onViewportChange:function(t){return e.setState({viewport:t})},mapboxApiAccessToken:b,onClick:this.closePopup}),r.a.createElement(y,{info:o,onClose:this.closePopup}),a.map((function(t,n){var a=t.categoryName,o=t.points,c=t.color;return r.a.createElement(C,{key:n,category:a,data:o,onClick:e.openPopup,color:c})}))))}}]),n}(r.a.Component),S=function(e){var t=e.category,n=e.points,a=e.onClick;return r.a.createElement("div",{className:"PointList"},n.map((function(e){var n,o,c=null===(n=e.geometry)||void 0===n?void 0:n.coordinates,i=Object(E.a)(c,2),l=i[0],s=i[1],u=e.properties,p=u.name,m=u.id,f={category:t,lat:s,long:l,text:p};return r.a.createElement("div",{key:m,className:"PointItem",onClick:function(){return a(f)}},null===(o=e.properties)||void 0===o?void 0:o.name)})))},I=n(14),x=function(e){var t=e.pointsByCategory,n=e.changePopup,a=!0;return t.forEach((function(e){a=e.points.length<=0})),a?null:r.a.createElement("div",{className:"Points"},r.a.createElement(I.d,{className:"Tabs"},r.a.createElement(I.b,{className:"TabList"},r.a.createElement("span",{className:"PointsTitle"},"Points"),t.map((function(e,t){return r.a.createElement(I.a,{key:t,className:"Tab"},e.categoryName)}))),t.map((function(e,t){return r.a.createElement(I.c,{key:t,className:"TabPanel"},r.a.createElement(S,{category:e.categoryName,points:e.points,onClick:n}))}))))},B=n(19),R=new(function(){function e(){Object(u.a)(this,e),this.urlRoot=void 0,this.defaultOptions=void 0,this.urlRoot="".concat(v),this.defaultOptions={redirect:"follow"}}return Object(p.a)(e,[{key:"get",value:function(){var e=Object(s.a)(l.a.mark((function e(){var t,n,a,r,o,c,i=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:"",n=i.length>1&&void 0!==i[1]?i[1]:{},a=i.length>2?i[2]:void 0,r="".concat(this.urlRoot).concat(t),Object.keys(n).length>0&&(o=new URLSearchParams(n),r="".concat(r,"?").concat(o.toString())),e.prev=5,e.next=8,fetch(r,Object(B.a)(Object(B.a)({},this.defaultOptions),a));case 8:if((c=e.sent).ok){e.next=11;break}throw new Error("Bad request");case 11:return e.abrupt("return",c.json());case 14:throw e.prev=14,e.t0=e.catch(5),new Error(e.t0);case 17:case"end":return e.stop()}}),e,this,[[5,14]])})));return function(){return e.apply(this,arguments)}}()}]),e}()),F=function(e){Object(m.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:{},popupInfo:null},e.triggerSimulation=function(){var t=Object(s.a)(l.a.mark((function t(n){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R.get("kpis",{number_of_requests:n});case 3:a=t.sent,e.setState({data:a}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),e.getGeoFeatures=function(e){try{return JSON.parse(e).features||[]}catch(t){return console.log(t),[]}},e.changePopup=function(t){e.setState({popupInfo:t})},e}return Object(p.a)(n,[{key:"render",value:function(){var e=this.state,t=e.data,n=e.popupInfo,a=t.booking_distance_bins,o=void 0===a?{}:a,c=t.most_popular_dropoff_points,i=void 0===c?"{}":c,l=t.most_popular_pickup_points,s=void 0===l?"{}":l,u=[{categoryId:"pickup",categoryName:"Pick up",points:this.getGeoFeatures(s),color:"#085156"},{categoryId:"dropoff",categoryName:"Drop off",points:this.getGeoFeatures(i),color:"#26c4b8"}];return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"AppSidebar"},r.a.createElement("h1",{className:"AppHeader"},"KPI Simulator"),r.a.createElement(d,{onSubmit:this.triggerSimulation}),r.a.createElement(h,{bins:o}),r.a.createElement(x,{pointsByCategory:u,changePopup:this.changePopup})),r.a.createElement(P,{pointsByCategory:u,popupInfo:n,changePopup:this.changePopup}))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[24,1,2]]]);
//# sourceMappingURL=main.d1b2719c.chunk.js.map